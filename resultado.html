<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados | Anova Sa√∫de</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=Work+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="index.html" class="logo">
                    <img src="logo.png" alt="Anova Sa√∫de">
                </a>
                <ul class="nav-links">
                    <li><a href="index.html#testes">Cat√°logo de Testes</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="results-container">
        <div class="test-header">
            <h1 id="test-title">Seus Resultados</h1>
            <p id="test-name"></p>
        </div>

        <div class="score-display">
            <div class="score-label">Sua Pontua√ß√£o</div>
            <div class="score-number" id="score-number">--</div>
            <div class="score-label" id="score-range">de --</div>
            <span class="severity-badge" id="severity-badge">--</span>
        </div>

        <div class="interpretation">
            <h3>Interpreta√ß√£o Autom√°tica</h3>
            <p id="interpretation-text"></p>
        </div>

        <div class="professional-analysis">
            <h3>üéØ Interpreta√ß√£o Profissional Detalhada</h3>
            <p>Receba uma an√°lise completa e personalizada elaborada por profissionais especializados em sa√∫de mental.</p>
            <div class="price">R$ 30,00</div>
            <p style="font-size: 0.95rem; opacity: 0.9; margin-bottom: 1.5rem;">
                ‚Ä¢ An√°lise detalhada das suas respostas<br>
                ‚Ä¢ Recomenda√ß√µes personalizadas<br>
                ‚Ä¢ Orienta√ß√µes profissionais espec√≠ficas
            </p>
            <button class="btn btn-purchase" id="purchase-btn">
                Solicitar Interpreta√ß√£o Profissional
            </button>
            <p style="font-size: 0.85rem; margin-top: 1rem; opacity: 0.8;">
                ID do Resultado: <strong id="result-id-display">--</strong>
            </p>
        </div>

        <div class="disclaimer">
            <strong>Aviso Importante:</strong> Este teste √© uma ferramenta de rastreamento e n√£o substitui uma avalia√ß√£o cl√≠nica completa. 
            Se voc√™ est√° enfrentando dificuldades emocionais, recomendamos fortemente buscar apoio de um profissional de sa√∫de mental qualificado.
        </div>

        <div class="test-navigation" style="margin-top: 2rem;">
            <a href="index.html" class="btn btn-secondary">Voltar ao In√≠cio</a>
            <button class="btn btn-primary" id="download-btn">Baixar Resultados (JSON)</button>
        </div>
    </div>

    <script src="js/storage.js"></script>
    <script>
        // Get result ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const resultId = urlParams.get('id');

        // Load and display results
        function loadResults() {
            if (!resultId) {
                alert('Nenhum resultado encontrado. Redirecionando...');
                window.location.href = 'index.html';
                return;
            }

            const result = Storage.getResult(resultId);
            
            if (!result) {
                alert('Resultado n√£o encontrado. Redirecionando...');
                window.location.href = 'index.html';
                return;
            }

            displayResults(result);
        }

        // Display results on page
        function displayResults(result) {
            document.getElementById('test-name').textContent = result.testTitle;
            document.getElementById('score-number').textContent = result.score;
            document.getElementById('score-range').textContent = `de ${result.maxScore}`;
            document.getElementById('interpretation-text').textContent = result.interpretation.description;
            document.getElementById('result-id-display').textContent = resultId;

            // Set severity badge
            const badge = document.getElementById('severity-badge');
            const level = result.interpretation.level.toLowerCase();
            badge.textContent = result.interpretation.level;
            badge.className = `severity-badge severity-${level}`;
        }

        // Setup purchase button
        function setupPurchaseButton() {
            document.getElementById('purchase-btn').addEventListener('click', () => {
                // TODO: Integrate with Nuvem Shop
                // For now, show alert with instructions
                alert(
                    `Para solicitar a interpreta√ß√£o profissional:\n\n` +
                    `1. Anote seu ID de resultado: ${resultId}\n` +
                    `2. Voc√™ ser√° redirecionado para o pagamento\n` +
                    `3. Informe este ID no campo de observa√ß√µes\n\n` +
                    `Ap√≥s o pagamento, enviaremos sua an√°lise detalhada por email em at√© 48h.`
                );
                
                // Redirect to Nuvem Shop (replace with your actual store URL)
                // window.location.href = 'https://sua-loja.nuvemshop.com.br/produtos/interpretacao-profissional';
            });
        }

        // Setup download button
        function setupDownloadButton() {
            document.getElementById('download-btn').addEventListener('click', () => {
                Storage.exportResult(resultId);
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadResults();
            setupPurchaseButton();
            setupDownloadButton();
        });
    </script>
</body>
</html>
